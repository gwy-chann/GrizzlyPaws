<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Grizzly Paws | Pet's Products</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <link rel="icon" type="image/x-icon" href="/images/favicon.png" />
    <link rel="stylesheet" href="../../../styles/css category/header&footer.css" />
    <link rel="stylesheet" href="../../../styles/css category items/dogItem.css">
    <style>
/* Reviews Section */
.reviews-section {
  max-width: 1200px;
  margin: 50px auto;
  padding: 0 20px;
}

.reviews-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 30px;
  padding-bottom: 15px;
  border-bottom: 2px solid #e0e0e0;
}

.reviews-header h2 {
  font-size: 28px;
  color: #333;
  margin: 0;
}

.write-review-btn {
  background-color: #b7e6b7;
  color: rgb(41, 102, 1);
  border: none;
  padding: 12px 24px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 8px;
  transition: background-color 0.3s ease;
}

.write-review-btn:hover {
  background-color: #7dcf81;
}

.reviews-container {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.review-card {
  background: #fff;
  border: 1px solid #e0e0e0;
  border-radius: 8px;
  padding: 20px;
  transition: box-shadow 0.3s ease;
}

.review-card:hover {
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.review-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 12px;
}

.reviewer-info {
  display: flex;
  align-items: center;
  gap: 12px;
}

.reviewer-avatar {
  width: 40px;
  height: 40px;
  background: linear-gradient(135deg, #09692e 0%, #aee6ad 100%);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: 600;
  font-size: 18px;
}

.reviewer-details h4 {
  margin: 0;
  font-size: 16px;
  color: #333;
  font-weight: 600;
}

.review-date {
  font-size: 13px;
  color: #666;
  margin-top: 2px;
}

.review-actions {
  display: flex;
  gap: 8px;
}

.review-action-btn {
  background: none;
  border: none;
  cursor: pointer;
  padding: 6px 10px;
  border-radius: 4px;
  color: #666;
  font-size: 14px;
  transition: all 0.2s ease;
}

.review-action-btn:hover {
  background: #f5f5f5;
  color: #333;
}

.review-action-btn.edit:hover {
  color: #398b13;
}

.review-action-btn.delete:hover {
  color: #dc3545;
}

.review-content {
  font-size: 15px;
  line-height: 1.6;
  color: #444;
  margin-top: 8px;
}

.review-hidden {
  color: #dc3545;
  font-weight: 600;
  font-style: italic;
  padding: 15px;
  background: #ffe6e6;
  border-left: 4px solid #dc3545;
  border-radius: 4px;
}

.no-reviews {
  text-align: center;
  padding: 60px 20px;
  color: #999;
}

.no-reviews i {
  font-size: 48px;
  color: #ddd;
  margin-bottom: 15px;
}

.no-reviews p {
  font-size: 18px;
  margin: 10px 0;
}

/* Review Modal */
.review-modal {
  display: none;
  position: fixed;
  z-index: 1000;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.5);
  animation: fadeIn 0.3s ease;
}

.review-modal-content {
  background-color: white;
  margin: 5% auto;
  border-radius: 12px;
  width: 90%;
  max-width: 600px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
  animation: slideDown 0.3s ease;
}

.review-modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20px 25px;
  border-bottom: 1px solid #e0e0e0;
}

.review-modal-header h3 {
  margin: 0;
  font-size: 22px;
  color: #333;
}

.review-modal-close {
  background: none;
  border: none;
  font-size: 32px;
  color: #999;
  cursor: pointer;
  transition: color 0.2s ease;
  line-height: 1;
  padding: 0;
  width: 32px;
  height: 32px;
}

.review-modal-close:hover {
  color: #333;
}

.review-modal-body {
  padding: 25px;
}

.review-textarea {
  width: 100%;
  min-height: 150px;
  padding: 15px;
  border: 2px solid #e0e0e0;
  border-radius: 8px;
  font-size: 15px;
  font-family: inherit;
  resize: vertical;
  transition: border-color 0.2s ease;
  box-sizing: border-box;
}

.review-textarea:focus {
  outline: none;
  border-color: #88cc5b;
}

.character-count {
  text-align: right;
  font-size: 13px;
  color: #999;
  margin-top: 8px;
}

.review-modal-footer {
  display: flex;
  justify-content: flex-end;
  gap: 12px;
  padding: 20px 25px;
  border-top: 1px solid #e0e0e0;
}

.btn-cancel-review,
.btn-submit-review {
  padding: 10px 24px;
  border: none;
  border-radius: 6px;
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
}

.btn-cancel-review {
  background: #f5f5f5;
  color: #666;
}

.btn-cancel-review:hover {
  background: #e0e0e0;
}

.btn-submit-review {
  background: #b7e6b7;
  color: rgb(41, 102, 1);
}

.btn-submit-review:hover {
  background: #7dcf81;
}

.btn-submit-review:disabled {
  background: #ccc;
  color: #666;
  cursor: not-allowed;
}

/* ADD THESE NEW STYLES TO YOUR EXISTING REVIEW CSS */

/* Disabled Write Review Button */
.write-review-btn.disabled {
  background-color: #f3d8d8;
  cursor: pointer;
  color: #790000;
  opacity: 0.7;
}

.write-review-btn.disabled:hover {
  background-color: #f3cece;
}

/* Purchase Required Modal (keep this for purchase validation) */
.login-required-modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.6);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 10000;
  animation: fadeIn 0.3s ease-out;
}

.login-required-content {
  background: white;
  border-radius: 15px;
  padding: 40px;
  max-width: 450px;
  width: 90%;
  text-align: center;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
  animation: slideUp 0.3s ease-out;
}

.login-required-icon {
  width: 80px;
  height: 80px;
  background: linear-gradient(135deg, #78ba37, #5a8c2f);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto 25px;
  font-size: 35px;
  color: white;
}

.login-required-content h3 {
  font-size: 24px;
  color: #333;
  margin-bottom: 15px;
  font-weight: 600;
}

.login-required-content p {
  font-size: 16px;
  color: #666;
  margin-bottom: 30px;
  line-height: 1.6;
}

.login-required-actions {
  display: flex;
  gap: 15px;
  justify-content: center;
}

.btn-close-modal {
  padding: 12px 30px;
  border: 2px solid #ddd;
  background: white;
  color: #666;
  border-radius: 25px;
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
}

.btn-close-modal:hover {
  border-color: #999;
  color: #333;
  background: #f5f5f5;
}

.btn-go-login {
  padding: 12px 30px;
  border: none;
  background: linear-gradient(135deg, #78ba37, #5a8c2f);
  color: white;
  border-radius: 25px;
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
  text-decoration: none;
  display: inline-block;
}

.btn-go-login:hover {
  background: linear-gradient(135deg, #5a8c2f, #78ba37);
  transform: translateY(-2px);
  box-shadow: 0 4px 15px rgba(120, 186, 55, 0.3);
}

/* Success Message */
.review-success-message {
  position: fixed;
  top: 20px;
  left: 50%;
  transform: translateX(-50%) translateY(-100px);
  background: linear-gradient(135deg, #2ecc71, #27ae60);
  color: white;
  padding: 15px 30px;
  border-radius: 50px;
  box-shadow: 0 4px 20px rgba(46, 204, 113, 0.3);
  display: flex;
  align-items: center;
  gap: 12px;
  font-weight: 600;
  z-index: 10001;
  opacity: 0;
  transition: all 0.3s ease-out;
}

.review-success-message.show {
  opacity: 1;
  transform: translateX(-50%) translateY(0);
}

.review-success-message i {
  font-size: 20px;
}
/* Star Rating Styles */
.review-rating {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-top: 4px;
}

.review-stars {
  display: flex;
  gap: 2px;
}

.review-stars svg {
  width: 16px;
  height: 16px;
  fill: #ffa500;
}

.review-stars svg.empty {
  fill: #e0e0e0;
}

/* Star Rating Input in Modal */
.rating-input-container {
  margin-bottom: 20px;
  text-align: center;
}

.rating-input-container label {
  display: block;
  font-size: 16px;
  font-weight: 600;
  color: #333;
  margin-bottom: 12px;
}

.star-rating-input {
  display: flex;
  justify-content: center;
  gap: 8px;
  cursor: pointer;
}

.star-rating-input svg {
  width: 32px;
  height: 32px;
  fill: #e0e0e0;
  transition: all 0.2s ease;
  cursor: pointer;
}

.star-rating-input svg:hover,
.star-rating-input svg.active {
  fill: #ffa500;
  transform: scale(1.1);
}

.star-rating-input svg:hover ~ svg {
  fill: #e0e0e0;
}

.rating-value-display {
  margin-top: 8px;
  font-size: 14px;
  color: #666;
  font-weight: 500;
}

/* Update reviews header to show average rating */
.reviews-header-content {
  display: flex;
  align-items: center;
  gap: 15px;
}

.average-rating-display {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 16px;
  background: #f8f8f8;
  border-radius: 6px;
}

.average-rating-number {
  font-size: 24px;
  font-weight: 700;
  color: #333;
}

.average-rating-stars {
  display: flex;
  gap: 2px;
}

.average-rating-stars svg {
  width: 18px;
  height: 18px;
  fill: #ffa500;
}

.average-rating-stars svg.half {
  position: relative;
}

.average-rating-stars svg.empty {
  fill: #e0e0e0;
}

.review-count-text {
  font-size: 13px;
  color: #666;
}

/* Animations */
@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes slideUp {
  from {
    transform: translateY(50px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

/* Responsive */
@media (max-width: 480px) {
  .login-required-content {
    padding: 30px 20px;
  }

  .login-required-icon {
    width: 70px;
    height: 70px;
    font-size: 30px;
  }

  .login-required-content h3 {
    font-size: 20px;
  }

  .login-required-actions {
    flex-direction: column;
  }

  .btn-close-modal,
  .btn-go-login {
    width: 100%;
  }

  .review-success-message {
    width: 90%;
    padding: 12px 20px;
    font-size: 14px;
  }
}

/* Animations */
@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes slideDown {
  from {
    transform: translateY(-50px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

/* Responsive Design */
@media (max-width: 768px) {
  .reviews-header {
    flex-direction: column;
    gap: 15px;
    align-items: flex-start;
  }

  .write-review-btn {
    width: 100%;
    justify-content: center;
  }

  .review-header {
    flex-direction: column;
    gap: 12px;
  }

  .review-actions {
    width: 100%;
    justify-content: flex-start;
  }

  .review-modal-content {
    margin: 10% auto;
    width: 95%;
  }
}
</style>

  </head>
  <body>
    <header>
      <div class="header-top">
        <div class="logo-container">
          <button class="mobile-menu-button">‚ò∞</button>
          <a
            href="/index.html"
            title="Return to Homepage"
            aria-label="Go to Homepage"
          >
            <img
              src="../../../../../images/logo3.png"
              alt="Logo"
              class="logo"
            />
          </a>
        </div>

        <div class="search-container">
          <form action="/search" method="get" role="search">
            <input
              type="text"
              id="site-search"
              placeholder="Search products..."
              name="search"
              class="search-input"
              for="site-search"
            />
            <button type="submit" class="search-button" aria-label="Search">
              <i class="fas fa-search" aria-hidden="true"></i>
            </button>
          </form>
        </div>
        <div class="basket-container">
          <a
            href="../../basket.html"
            class="basket-button"
            aria-label="Shopping basket"
          >
            <i class="fas fa-shopping-cart" aria-hidden="true"></i>
            <span>BASKET</span>
          </a>

          <!-- Notification Dropdown -->
          <div class="notification-dropdown">
            <a class="notification-button" aria-label="Notifications">
              <i class="fas fa-bell" aria-hidden="true"></i>
              <span class="notification-badge">2</span>
            </a>
            <div class="dropdown-content notification-content">
              <div class="dropdown-tail"></div>
              <div class="notification-header">
                <h3>Notifications</h3>
                <a href="#" class="mark-all-read">Mark all as read</a>
              </div>
              <div class="notification-list">
                <a href="#" class="notification-item unread">
                  <div class="notification-icon order">
                    <i class="fas fa-box"></i>
                  </div>
                  <div class="notification-text">
                    <p class="notification-title">Order Shipped</p>
                    <p class="notification-message">Your order #12345 has been shipped and will arrive in 2-3 days.</p>
                    <span class="notification-time">2 hours ago</span>
                  </div>
                </a>
                <a href="#" class="notification-item unread">
                  <div class="notification-icon promo">
                    <i class="fas fa-tag"></i>
                  </div>
                  <div class="notification-text">
                    <p class="notification-title">Special Offer!</p>
                    <p class="notification-message">Get 20% off on all electronics. Limited time offer!</p>
                    <span class="notification-time">5 hours ago</span>
                  </div>
                </a>
              </div>
              <a href="#" class="view-all-notifications">View All Notifications</a>
            </div>
          </div>

          <!-- Account Dropdown -->
          <div class="account-dropdown">
            <a class="account-button" aria-label="My account">
              <i class="fas fa-user-circle" aria-hidden="true"></i>
            </a>
            <div class="dropdown-content">
              <div class="dropdown-tail"></div>
              <a href="../../account.html">My Account</a>
              <a href="../../Purchase/purchase.html">My Purchase</a>
              <a href="../../Purchase/wishlist.css">Wishlist</a>
              <a href="../../../login.html">Logout</a>
            </div>
          </div>
        </div>
      </div>

      <nav aria-label="Main navigation" id="main-nav"></nav>
    </header>

    <main class="container" >
      <div class="breadcrumb">
        <a href="../../../index.html">
            <svg class="home-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                <polyline points="9 22 9 12 15 12 15 22"></polyline>
            </svg>
        </a>
        <span class="separator">
          <svg width="8" height="12" viewBox="0 0 8 12" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M1.5 1L6.5 6L1.5 11" stroke="#666" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </span>
        <span id="first-breadcrumb">Pet</span>
        <span class="separator">
          <svg width="8" height="12" viewBox="0 0 8 12" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M1.5 1L6.5 6L1.5 11" stroke="#666" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </span>
        <span id="sub-category-item">Sub Category</span>
        <span class="separator">
          <svg width="8" height="12" viewBox="0 0 8 12" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M1.5 1L6.5 6L1.5 11" stroke="#666" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </span>
        <span id="product-detail-item">Product Detail</span>
    </div>
      <div class="product-container">
        <div class="product-images">
          <div class="main-image">
            <div class="navigation-arrow prev">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M15 18l-6-6 6-6"/>
              </svg>
            </div>
            <img src="../../Hill'sPrescriptionDietCanineMetabolic1.jpg" alt="Royal Canin Medium Adult dog food" id="display_image">
            <div class="navigation-arrow next">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M9 18l6-6-6-6"/>
              </svg>
            </div>
          </div>
          <div class="thumbnail-container" id="thumbnail-container">
            <!-- <div class="thumbnail active">
              <img src="../../Hill'sPrescriptionDietCanineMetabolic1.jpg" alt="Thumbnail 1">
            </div> -->
          </div>
        </div>
    
        <div class="product-info">
          <div class="product-title">
            <span id="product_title"></span>
            <span class="favorite-icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
              </svg>
            </span>
          </div>
          
          <div class="price-wrapper">
            <div class="price" id="price-display"></div>
            <div class="original-price">‚Ç± 3,500</div>
          </div>
          

          <div class="rating">
            <div class="stars">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
              </svg>
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
              </svg>
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
              </svg>
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
              </svg>
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
              </svg>
            </div>
            <span class="review-count">4.5</span>
          </div>

          <p class="product-description" id="product_description">
          </p>
    
          <label class="options-label">Choose item</label>
          <div class="select-wrapper">
            <select class="custom-select" id="custom_select">
              <option value="15kg" data-price="2,500">15kg</option>
              <option value="10kg" data-price="1,700">10kg</option>
              <option value="7kg" data-price="1,500">7kg</option>
              <option value="4kg" data-price="1,300">4kg</option>
            </select>
            </span>
          </div>
    
            <!-- HTML -->
            <div class="quantity-container">
              <!-- <div class="quantity-control">
                <button class="quantity-btn decrease">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                  </svg>
                </button>
          
                <input 
                  type="text" 
                  class="quantity-input" 
                  value="1" 
                  onkeydown="return onlyNumberKey(event)"
                >
                <button class="quantity-btn increase">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="12" y1="5" x2="12" y2="19"></line>
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                  </svg>
                </button>
              </div> -->

              <div class="quantity-control">
                <button class="quantity-btn decrease">‚àí</button>
                <input  type="text" 
                class="quantity-input" 
                value="1" 
                onkeydown="return onlyNumberKey(event)">
                <button class="quantity-btn increase">+</button>
            </div>
               
              <button class="add-to-cart add-to-basket-button" id="myBasket">
                <i class="fas fa-shopping-cart" aria-hidden="true"></i>
                Add to basket
              </button>
            </div>
    
            <div class="details">
              <div class="shipping-details">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg" role="img" class="DeliveryInfo_icon__KXrnj" aria-hidden="true" data-pp-icon="TruckShipping"><path fill-rule="evenodd" clip-rule="evenodd" d="M2 6.75C2 5.23122 3.23118 4 4.75 4H13.25C14.5088 4 15.57 4.84575 15.8965 6H17.9521C18.8545 6 19.6995 6.44272 20.2131 7.18467L21.511 9.05942C21.8294 9.51932 22 10.0653 22 10.6248V14.2857C22 15.5389 21.1507 16.5937 19.9963 16.906C19.9149 18.6285 18.4926 20 16.75 20C15.0392 20 13.6371 18.6781 13.5095 17H10.4905C10.3629 18.6781 8.9608 20 7.25 20C5.51284 20 4.09399 18.637 4.00449 16.9222C2.85321 16.6362 2 15.5958 2 14.3561V6.75ZM4.27515 15.4393C4.7791 14.2972 5.92146 13.5 7.25 13.5C8.60196 13.5 9.76113 14.3255 10.2509 15.5H13.7491C13.9225 15.0841 14.1799 14.712 14.5 14.4048V6.75C14.5 6.05964 13.9404 5.5 13.25 5.5H4.75C4.05962 5.5 3.5 6.05964 3.5 6.75V14.3561C3.5 14.8589 3.82431 15.2858 4.27515 15.4393ZM16 7.5V13.587C16.2408 13.5301 16.4919 13.5 16.75 13.5C18.0715 13.5 19.2089 14.2888 19.7168 15.4212C20.1746 15.2473 20.5 14.8045 20.5 14.2857V10.6248C20.5 10.3705 20.4225 10.1223 20.2777 9.91324L18.9798 8.03849C18.7464 7.70124 18.3623 7.5 17.9521 7.5H16ZM7.25 15C6.28351 15 5.5 15.7835 5.5 16.75C5.5 17.7165 6.28351 18.5 7.25 18.5C8.21649 18.5 9 17.7165 9 16.75C9 15.7835 8.21649 15 7.25 15ZM16.75 15C15.7835 15 15 15.7835 15 16.75C15 17.7165 15.7835 18.5 16.75 18.5C17.7165 18.5 18.5 17.7165 18.5 16.75C18.5 15.7835 17.7165 15 16.75 15Z"></path></svg>
                Delivery in 3-6 working days
              </div>
      
              <div class="shipping-details">
               <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg" role="img" class="ReturnPolicyLink_icon__cH85u" aria-hidden="true" data-pp-icon="OrderReturn"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.84083 3.49994C5.20864 2.94819 5.82785 2.61675 6.49096 2.6167H13.8104C14.4721 2.61807 15.0895 2.94936 15.4565 3.49995L17.7259 6.90449C18.0808 7.26284 18.3 7.75584 18.3 8.30003V9.53337C18.3 9.94758 17.9642 10.2834 17.55 10.2834C17.1358 10.2834 16.8 9.94758 16.8 9.53337V8.30003C16.8 8.17313 16.7511 8.05765 16.6711 7.97142C16.6522 7.95558 16.6339 7.93871 16.6164 7.92082C16.534 7.85562 16.4299 7.8167 16.3167 7.8167H3.98333C3.86974 7.8167 3.76529 7.85589 3.68278 7.92149C3.66573 7.93887 3.64796 7.95528 3.62955 7.97072C3.54917 8.05703 3.5 8.17279 3.5 8.30003V16.9334C3.5 17.2003 3.7164 17.4167 3.98333 17.4167H8.91667C9.33088 17.4167 9.66667 17.7525 9.66667 18.1667C9.66667 18.5809 9.33088 18.9167 8.91667 18.9167H3.98333C2.88797 18.9167 2 18.0287 2 16.9334V8.30003C2 7.75622 2.21887 7.26352 2.57332 6.90523L4.84083 3.49994ZM4.76733 6.3167H9.4V4.1167H6.49107C6.32953 4.11673 6.17864 4.19746 6.089 4.33184L4.76733 6.3167ZM10.9 4.1167V6.3167H15.5314L14.2084 4.33194C14.1191 4.19794 13.9689 4.11723 13.8078 4.1167H10.9ZM15.6137 11.4697C15.9066 11.7626 15.9066 12.2375 15.6137 12.5304L14.4273 13.7167H15.0833C18.9033 13.7167 22 16.8134 22 20.6334C22 21.0476 21.6642 21.3834 21.25 21.3834C20.8358 21.3834 20.5 21.0476 20.5 20.6334C20.5 17.6418 18.0749 15.2167 15.0833 15.2167H14.4273L15.6137 16.403C15.9066 16.6959 15.9066 17.1708 15.6137 17.4637C15.3208 17.7566 14.8459 17.7566 14.553 17.4637L12.0863 14.997C11.9457 14.8564 11.8667 14.6656 11.8667 14.4667C11.8667 14.2678 11.9457 14.077 12.0863 13.9364L14.553 11.4697C14.8459 11.1768 15.3208 11.1768 15.6137 11.4697Z"></path></svg>
               Return Policy 
               <a href="#" class="green-text">
                more
              </a>
            </div>
      
            <p class="note">All prices include statutory VAT. Additional <span class="green-text">shipping costs</span> may apply.</p>
            </div>
            
        </div>
      </div>

      <!-- Review Section -->
      <section class="reviews-section">
  <div class="reviews-header">
    <h2>Customer Reviews</h2>
    <button class="write-review-btn" id="writeReviewBtn">
      <i class="fas fa-pen"></i>
      Write a Review
    </button>
  </div>

  <div class="reviews-container" id="reviewsContainer">
    <!-- Reviews will be dynamically inserted here -->
  </div>
</section>

<!-- Write Review Modal -->
<!-- Write Review Modal -->
<div class="review-modal" id="reviewModal">
  <div class="review-modal-content">
    <div class="review-modal-header">
      <h3 id="modalTitle">Write Your Review</h3>
      <button class="review-modal-close" id="closeModal">&times;</button>
    </div>
    
    <div class="review-modal-body">
      <div class="rating-input-container">
        <label for="reviewRating">Rate this product</label>
        <div class="star-rating-input" id="starRatingInput">
          <svg data-rating="1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
          </svg>
          <svg data-rating="2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
          </svg>
          <svg data-rating="3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
          </svg>
          <svg data-rating="4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
          </svg>
          <svg data-rating="5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
          </svg>
        </div>
        <div class="rating-value-display" id="ratingValueDisplay">Select a rating</div>
      </div>
      
      <textarea 
        id="reviewText" 
        class="review-textarea" 
        placeholder="Share your thoughts about this product..."
        maxlength="1000"
      ></textarea>
      <div class="character-count">
        <span id="charCount">0</span>/1000 characters
      </div>
    </div>
    
    <div class="review-modal-footer">
      <button class="btn-cancel-review" id="cancelReview">Cancel</button>
      <button class="btn-submit-review" id="submitReview">Post Review</button>
    </div>
  </div>
</div>
  


      <!-- Modal -->
      <div class="modal" id="myModal"> 
        <div class="modal-content">
          <span class="close">&times;</span>
          <div class="success-message">
            <div class="success-icon">
              <i class="fas fa-check-circle"></i>
            </div>
            <h3>Added to Basket! üêæ</h3>
            <p id="modal-product-info">Your item has been added to the basket.</p>
            <div class="modal-buttons">
              <button class="continue-shopping">Continue Shopping</button>
              <button class="view-basket">View Basket</button>
            </div>
          </div>
        </div>
      </div>
    
      

    </main>

    <div class="newsletter-banner">
      <div class="years-badge">
        <div class="years-number">2025</div>
        <div class="years-text">New beginnings, same love for pets</div>
        <div class="paw-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
            <path
              d="M256 224c-79.41 0-192 122.76-192 200.25 0 34.9 26.81 55.75 71.74 55.75 48.84 0 81.09-25.08 120.26-25.08 39.51 0 71.85 25.08 120.26 25.08 44.93 0 71.74-20.85 71.74-55.75C448 346.76 335.41 224 256 224zm-147.28-12.61c-10.4-34.65-42.44-57.09-71.56-50.13-29.12 6.96-44.29 40.69-33.89 75.34 10.4 34.65 42.44 57.09 71.56 50.13 29.12-6.96 44.29-40.69 33.89-75.34zm84.72-20.78c30.94-8.14 46.42-49.94 34.58-93.36s-46.52-72.01-77.46-63.87-46.42 49.94-34.58 93.36c11.84 43.42 46.53 72.02 77.46 63.87zm281.39-29.34c-29.12-6.96-61.15 15.48-71.56 50.13-10.4 34.65 4.77 68.38 33.89 75.34 29.12 6.96 61.15-15.48 71.56-50.13 10.4-34.65-4.77-68.38-33.89-75.34zm-156.27 29.34c30.94 8.14 65.62-20.45 77.46-63.87 11.84-43.42-3.64-85.21-34.58-93.36s-65.62 20.45-77.46 63.87c-11.84 43.42 3.64 85.22 34.58 93.36z"
            />
          </svg>
        </div>
      </div>

      <div class="newsletter-content">
        <h2 class="newsletter-title">
          Do not miss out on personalised offers, discounts and coupons!
        </h2>
        <form class="newsletter-form">
          <div class="select-container">
            <select class="pet-type-select" aria-label="Select pet type">
              <option value="" disabled selected>Please select pet type</option>
              <option value="dog">Dog</option>
              <option value="cat">Cat</option>
              <option value="bird">Bird</option>
              <option value="fish">Fish</option>
              <option value="reptile">Reptile</option>
              <option value=" small_pet">Small Pet</option>
            </select>
            <div class="select-arrow">
              <svg width="12" height="8" viewBox="0 0 12 8" fill="none">
                <path
                  d="M1 1L6 6L11 1"
                  stroke="#333"
                  stroke-width="2"
                  stroke-linecap="round"
                />
              </svg>
            </div>
          </div>

          <input
            type="email"
            class="email-input"
            placeholder="Email address"
            aria-label="Email address"
          />

          <button type="submit" class="subscribe-btn">Subscribe</button>
        </form>
      </div>
    </div>

    <footer class="footer">
      <div class="footer-container">
        <div class="footer-section">
          <h3>Services</h3>
          <ul class="footer-links">
            <li><a href="#">FAQS</a></li>
            <li><a>Free Shipping & Delivery</a></li>
            <li><a href="#">Contact Us</a></li>

          </ul>
        </div>

        <div class="footer-section">
          <h3>Advantages</h3>
          <ul class="footer-links">
            <li><a>Newsletter</a></li>
          </ul>
        </div>


        <div class="footer-section">
          <div>
            <h3>Connect with us</h3>
            <ul class="footer-links">
              <li><a href="#">Our Team</a></li>
            </ul>
            <div style="display: flex; gap: 15px; margin-top: 10px">
              <a href="#" aria-label="Facebook">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="#666"
                >
                  <path
                    d="M12 2C6.477 2 2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.879V14.89h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.459h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.989C18.343 21.129 22 16.99 22 12c0-5.523-4.477-10-10-10z"
                  />
                </svg>
              </a>
              <a href="#" aria-label="YouTube">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="#666"
                >
                  <path
                    d="M21.543 6.498C22 8.28 22 12 22 12s0 3.72-.457 5.502c-.254.985-.997 1.76-1.938 2.022C17.896 20 12 20 12 20s-5.893 0-7.605-.476c-.945-.266-1.687-1.04-1.938-2.022C2 15.72 2 12 2 12s0-3.72.457-5.502c.254-.985.997-1.76 1.938-2.022C6.107 4 12 4 12 4s5.896 0 7.605.476c.945.266 1.687 1.04 1.938 2.022zM10 15.5l6-3.5-6-3.5v7z"
                  />
                </svg>
              </a>
            </div>
          </div>
        </div>
      </div>
      </footer>

    <!-- Chat Widget -->
    <script>
(function() {
  // Get current logged-in user from session
  let CURRENT_USER = null;
  
  // Sample reviews data structure (this will come from database)
  // Store reviews per product - format: productId_reviews
  let reviews = JSON.parse(localStorage.getItem('product_reviews') || '[]');
  
  // PRODUCT ID - Replace this with actual product ID from your page
  // You can get this from URL parameter or data attribute
  const PRODUCT_ID = getProductId(); // You'll implement this based on your page structure

  let editingReviewId = null;
  let selectedRating = 0; // NEW: Track selected star rating

  // DOM Elements
  const reviewsContainer = document.getElementById('reviewsContainer');
  const writeReviewBtn = document.getElementById('writeReviewBtn');
  const reviewModal = document.getElementById('reviewModal');
  const closeModal = document.getElementById('closeModal');
  const cancelReview = document.getElementById('cancelReview');
  const submitReview = document.getElementById('submitReview');
  const reviewText = document.getElementById('reviewText');
  const charCount = document.getElementById('charCount');
  const modalTitle = document.getElementById('modalTitle');
  const starRatingInput = document.getElementById('starRatingInput'); // NEW
  const ratingValueDisplay = document.getElementById('ratingValueDisplay'); // NEW

  // Initialize
  function init() {
    loadCurrentUser();
    renderReviews();
    setupEventListeners();
    updateWriteReviewButton();
    setupStarRating(); // NEW: Setup star rating functionality
  }

  // Load current user from session
  function loadCurrentUser() {
    const loggedInEmail = sessionStorage.getItem('loggedInUser');
    
    if (!loggedInEmail) {
      CURRENT_USER = null;
      return;
    }

    // Check if admin
    if (loggedInEmail === 'admin') {
      CURRENT_USER = {
        email: 'admin@gmail.com',
        name: 'Admin',
        userId: 'admin',
        isAdmin: true
      };
      return;
    }

    // Load user from localStorage
    const users = JSON.parse(localStorage.getItem('users') || '{}');
    const user = users[loggedInEmail];
    
    if (user) {
      CURRENT_USER = {
        email: user.email,
        name: `${user.firstname} ${user.lastname}`,
        userId: user.email, // Using email as userId
        firstname: user.firstname,
        middlename: user.middlename,
        lastname: user.lastname,
        isAdmin: false
      };
    } else {
      CURRENT_USER = null;
      sessionStorage.removeItem('loggedInUser'); // Clean up invalid session
    }
  }

  // Get product ID from page (CUSTOMIZE THIS BASED ON YOUR PAGE STRUCTURE)
  function getProductId() {
    // Option 1: Get from URL parameter
    const urlParams = new URLSearchParams(window.location.search);
    const productIdFromUrl = urlParams.get('id') || urlParams.get('productId');
    if (productIdFromUrl) return productIdFromUrl;

    // Option 2: Get from data attribute on page element
    const productElement = document.querySelector('[data-product-id]');
    if (productElement) return productElement.dataset.productId;

    // Option 3: Get from page title or other element
    // You can customize this based on your page structure
    
    // Default: use current page URL as product identifier
    return window.location.pathname;
  }

  // Update Write Review button based on login status
  function updateWriteReviewButton() {
    if (!CURRENT_USER) {
      writeReviewBtn.innerHTML = '<i class="fas fa-lock"></i> Login to Review';
      writeReviewBtn.classList.add('disabled');
    } else {
      writeReviewBtn.innerHTML = '<i class="fas fa-pen"></i> Write a Review';
      writeReviewBtn.classList.remove('disabled');
    }
  }

  // Check if user has purchased this product (PLACEHOLDER - IMPLEMENT LATER)
  function hasUserPurchasedProduct() {
    // TODO: Implement this when you have purchase history
    // For now, return true to allow all logged-in users to review
    
    // Future implementation example:
    // const purchases = JSON.parse(localStorage.getItem('user_purchases') || '[]');
    // return purchases.some(purchase => 
    //   purchase.userId === CURRENT_USER.userId && 
    //   purchase.productId === PRODUCT_ID &&
    //   purchase.status === 'completed'
    // );
    
    return true; // Allow all logged-in users for now
  }

  // NEW: Setup Star Rating Input
  function setupStarRating() {
    if (!starRatingInput) return; // Safety check
    
    const stars = starRatingInput.querySelectorAll('svg');
    
    stars.forEach(star => {
      star.addEventListener('click', function() {
        selectedRating = parseInt(this.getAttribute('data-rating'));
        updateStarDisplay();
        updateSubmitButton();
      });

      star.addEventListener('mouseenter', function() {
        const rating = parseInt(this.getAttribute('data-rating'));
        highlightStars(rating);
      });
    });

    starRatingInput.addEventListener('mouseleave', function() {
      highlightStars(selectedRating);
    });
  }

  // NEW: Highlight stars based on rating
  function highlightStars(rating) {
    if (!starRatingInput) return;
    
    const stars = starRatingInput.querySelectorAll('svg');
    stars.forEach((star, index) => {
      if (index < rating) {
        star.classList.add('active');
      } else {
        star.classList.remove('active');
      }
    });

    if (ratingValueDisplay) {
      if (rating > 0) {
        ratingValueDisplay.textContent = `${rating} ${rating === 1 ? 'star' : 'stars'}`;
      } else {
        ratingValueDisplay.textContent = 'Select a rating';
      }
    }
  }

  // NEW: Update star display
  function updateStarDisplay() {
    highlightStars(selectedRating);
  }

  // NEW: Reset star rating
  function resetStarRating() {
    selectedRating = 0;
    updateStarDisplay();
  }

  // NEW: Render star icons for reviews
  function renderStars(rating) {
    let starsHtml = '';
    for (let i = 1; i <= 5; i++) {
      const fillClass = i <= rating ? '' : 'empty';
      starsHtml += `
        <svg class="${fillClass}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
        </svg>
      `;
    }
    return starsHtml;
  }

  // NEW: Calculate average rating
  function calculateAverageRating() {
    const productReviews = reviews.filter(r => r.productId === PRODUCT_ID && !r.isHidden);
    if (productReviews.length === 0) return 0;
    
    const sum = productReviews.reduce((acc, review) => acc + (review.rating || 0), 0);
    return (sum / productReviews.length).toFixed(1);
  }

  // Setup Event Listeners
  function setupEventListeners() {
    writeReviewBtn.addEventListener('click', openNewReviewModal);
    closeModal.addEventListener('click', closeReviewModal);
    cancelReview.addEventListener('click', closeReviewModal);
    submitReview.addEventListener('click', handleSubmitReview);
    
    // UPDATED: Add rating validation
    reviewText.addEventListener('input', () => {
      updateCharCount();
      updateSubmitButton();
    });
    
    // Close modal when clicking outside
    window.addEventListener('click', (e) => {
      if (e.target === reviewModal) {
        closeReviewModal();
      }
    });

    // Close modal on Escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && reviewModal.style.display === 'block') {
        closeReviewModal();
      }
    });
  }

  // Format date to readable format
  function formatDate(date) {
    const now = new Date();
    const reviewDate = new Date(date);
    const diffTime = Math.abs(now - reviewDate);
    const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));

    if (diffDays === 0) {
      return 'Today';
    } else if (diffDays === 1) {
      return 'Yesterday';
    } else if (diffDays < 7) {
      return `${diffDays} days ago`;
    } else {
      const options = { year: 'numeric', month: 'short', day: 'numeric' };
      return reviewDate.toLocaleDateString('en-US', options);
    }
  }

  // Get user initials for avatar
  function getUserInitials(name) {
    return name
      .split(' ')
      .map(word => word[0])
      .join('')
      .toUpperCase()
      .slice(0, 2);
  }

  // UPDATED: Render all reviews with star ratings
  // UPDATED: Render all reviews with star ratings
function renderReviews() {
  // Filter reviews for current product
  const productReviews = reviews.filter(r => r.productId === PRODUCT_ID);

  // NEW: Update reviews header with average rating
  const avgRating = calculateAverageRating();
  const reviewCount = productReviews.filter(r => !r.isHidden).length;
  
  // UPDATE: Only update the header content, not the entire header
  const reviewsHeader = document.querySelector('.reviews-header');
  if (reviewsHeader) {
    // Check if header content already exists
    let headerContent = reviewsHeader.querySelector('.reviews-header-content');
    if (!headerContent) {
      // Create header content for the first time
      headerContent = document.createElement('div');
      headerContent.className = 'reviews-header-content';
      reviewsHeader.insertBefore(headerContent, reviewsHeader.firstChild);
    }
    
    // Update only the header content (not the button)
    headerContent.innerHTML = `
      <h2>Customer Reviews</h2>
      ${reviewCount > 0 ? `
        <div class="average-rating-display">
          <span class="average-rating-number">${avgRating}</span>
          <div class="average-rating-stars">${renderStars(Math.round(avgRating))}</div>
          <span class="review-count-text">(${reviewCount} ${reviewCount === 1 ? 'review' : 'reviews'})</span>
        </div>
      ` : ''}
    `;
  }

  if (productReviews.length === 0) {
    reviewsContainer.innerHTML = `
      <div class="no-reviews">
        <i class="fas fa-comments"></i>
        <p>No reviews yet</p>
        <p style="font-size: 14px; color: #aaa;">Be the first to share your thoughts!</p>
      </div>
    `;
    return;
  }

  // Sort reviews by date (newest first)
  const sortedReviews = [...productReviews].sort((a, b) => new Date(b.date) - new Date(a.date));

  reviewsContainer.innerHTML = sortedReviews.map(review => {
    const isOwnReview = CURRENT_USER && review.userId === CURRENT_USER.userId;
    
    return `
      <div class="review-card" data-review-id="${review.id}">
        <div class="review-header">
          <div class="reviewer-info">
            <div class="reviewer-avatar">
              ${getUserInitials(review.userName)}
            </div>
            <div class="reviewer-details">
              <h4>${escapeHtml(review.userName)}</h4>
              ${review.rating ? `
                <div class="review-rating">
                  <div class="review-stars">${renderStars(review.rating)}</div>
                </div>
              ` : ''}
              <div class="review-date">${formatDate(review.date)}</div>
            </div>
          </div>
          ${isOwnReview ? `
            <div class="review-actions">
              <button class="review-action-btn edit" onclick="editReview(${review.id})">
                <i class="fas fa-edit"></i> Edit
              </button>
              <button class="review-action-btn delete" onclick="deleteReview(${review.id})">
                <i class="fas fa-trash"></i> Delete
              </button>
            </div>
          ` : ''}
        </div>
        ${review.isHidden ? 
          '<div class="review-hidden">Review hidden by the admin</div>' : 
          `<div class="review-content">${escapeHtml(review.text)}</div>`
        }
      </div>
    `;
  }).join('');
}

  // Escape HTML to prevent XSS
  function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
  }

  // UPDATED: Open modal for new review
  function openNewReviewModal() {
    // Check if user is logged in
    if (!CURRENT_USER) {
      showLoginRequiredModal();
      return;
    }

    // Check if user has purchased product (PLACEHOLDER - implement later)
    if (!hasUserPurchasedProduct()) {
      showPurchaseRequiredModal();
      return;
    }

    editingReviewId = null;
    modalTitle.textContent = 'Write Your Review';
    reviewText.value = '';
    resetStarRating(); // NEW: Reset star rating
    updateCharCount();
    updateSubmitButton(); // NEW: Update button state
    reviewModal.style.display = 'block';
  }

  // Redirect to login page
  function showLoginRequiredModal() {
    // Store the current page URL to return after login (optional)
    // sessionStorage.setItem('returnUrl', window.location.href);
    
    // Redirect to login page
    window.location.href = '../../../login.html'; 
  }

  // Show purchase required modal (PLACEHOLDER - implement later)
  function showPurchaseRequiredModal() {
    const modal = document.createElement('div');
    modal.className = 'login-required-modal';
    modal.innerHTML = `
      <div class="login-required-content">
        <div class="login-required-icon" style="background: #f39c12;">
          <i class="fas fa-shopping-cart"></i>
        </div>
        <h3>Purchase Required</h3>
        <p>You need to purchase this product before you can write a review.</p>
        <div class="login-required-actions">
          <button class="btn-close-modal" onclick="this.closest('.login-required-modal').remove()">Cancel</button>
          <button class="btn-go-login" onclick="this.closest('.login-required-modal').remove()">Continue Shopping</button>
        </div>
      </div>
    `;
    document.body.appendChild(modal);

    // Close on outside click
    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        modal.remove();
      }
    });
  }

  // UPDATED: Open modal for editing review
  window.editReview = function(reviewId) {
    if (!CURRENT_USER) return;

    const review = reviews.find(r => r.id === reviewId);
    if (!review || review.userId !== CURRENT_USER.userId) return;

    editingReviewId = reviewId;
    modalTitle.textContent = 'Edit Your Review';
    reviewText.value = review.text;
    selectedRating = review.rating || 0; // NEW: Load existing rating
    updateStarDisplay(); // NEW: Display existing rating
    updateCharCount();
    updateSubmitButton(); // NEW: Update button state
    reviewModal.style.display = 'block';
  };

  // Delete review
  window.deleteReview = function(reviewId) {
    if (!CURRENT_USER) return;

    const review = reviews.find(r => r.id === reviewId);
    if (!review || review.userId !== CURRENT_USER.userId) return;

    if (confirm('Are you sure you want to delete this review?')) {
      reviews = reviews.filter(r => r.id !== reviewId);
      saveReviews();
      renderReviews();
      showSuccessMessage('Review deleted successfully');
    }
  };

  // UPDATED: Close modal
  function closeReviewModal() {
    reviewModal.style.display = 'none';
    editingReviewId = null;
    reviewText.value = '';
    resetStarRating(); // NEW: Reset star rating
  }

  // Update character count
  function updateCharCount() {
    const count = reviewText.value.length;
    charCount.textContent = count;
  }

  // NEW: Update submit button state
  function updateSubmitButton() {
    const hasText = reviewText.value.trim().length > 0;
    const hasRating = selectedRating > 0;
    submitReview.disabled = !(hasText && hasRating);
  }

  // UPDATED: Handle submit review
  function handleSubmitReview() {
    const text = reviewText.value.trim();
    
    if (!text) {
      alert('Please write a review before submitting.');
      return;
    }

    // NEW: Validate star rating
    if (selectedRating === 0) {
      alert('Please select a star rating.');
      return;
    }

    if (!CURRENT_USER) {
      alert('You must be logged in to post a review.');
      closeReviewModal();
      return;
    }

    if (editingReviewId) {
      // Update existing review
      const review = reviews.find(r => r.id === editingReviewId);
      if (review) {
        review.text = text;
        review.rating = selectedRating; // NEW: Save rating
        review.date = new Date().toISOString();
        review.editedAt = new Date().toISOString();
      }
    } else {
      // Create new review
      const newReview = {
        id: Date.now(),
        productId: PRODUCT_ID,
        userId: CURRENT_USER.userId,
        userName: CURRENT_USER.name,
        text: text,
        rating: selectedRating, // NEW: Save rating
        date: new Date().toISOString(),
        isHidden: false
      };
      
      reviews.push(newReview);
    }

    saveReviews();
    renderReviews();
    closeReviewModal();
    
    showSuccessMessage(editingReviewId ? 'Review updated successfully' : 'Review posted successfully');
  }

  // Save reviews to localStorage
  function saveReviews() {
    localStorage.setItem('product_reviews', JSON.stringify(reviews));
  }

  // Show success message
  function showSuccessMessage(message) {
    const successDiv = document.createElement('div');
    successDiv.className = 'review-success-message';
    successDiv.innerHTML = `
      <i class="fas fa-check-circle"></i>
      <span>${message}</span>
    `;
    document.body.appendChild(successDiv);

    setTimeout(() => {
      successDiv.classList.add('show');
    }, 10);

    setTimeout(() => {
      successDiv.classList.remove('show');
      setTimeout(() => successDiv.remove(), 300);
    }, 3000);
  }

  // Initialize on page load
  init();
})();
    </script>
    <script src="../../../js/actions.js"></script>
    <script src="../../../js/header.js"></script>
    <script src="../../../data/category.js"></script>
    <script src="../../../data/products.js"></script>
    <script src="../../../js/dynamic-display.js"></script>
    <script src="../../../js/dogItem.js"></script>
    <script src="index.js"></script>
  </body>
</html>
